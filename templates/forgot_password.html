{% extends "base.html" %}

{% block content %}
<div class="container d-flex justify-content-center align-items-center min-vh-100 py-4 px-2">
    <div class="card glass-card p-4 text-center position-relative"
         style="width: 100%; max-width: 380px; min-height: 440px;">

        <!-- Logo Badge -->
        <div class="logo-badge">
            <img src="{{ url_for('static', filename='img/barb_logo.png') }}" alt="BARB Logo">
        </div>

        <div class="mt-5 pt-3">
            <h5 class="mb-2 fw-bold text-dark">Create New Password</h5>
            <p class="text-secondary small mb-4">
                Enter a strong password you can remember.
            </p>

            <form method="POST" action="{{ url_for('reset_password', token=token) }}">
                <!-- New Password -->
                <div class="mb-3 text-start">
                    <label class="form-label small fw-bold text-muted">New Password</label>
                    <div class="input-group">
                        <input type="password"
                               name="password"
                               id="passwordField"
                               class="form-control py-2"
                               placeholder="At least 8 characters"
                               required>
                        <button class="btn btn-outline-secondary"
                                type="button"
                                onclick="togglePassword('passwordField', 'eyeIcon1')">
                            <i id="eyeIcon1" class="fas fa-eye-slash"></i>
                        </button>
                    </div>
                </div>

                <!-- Confirm Password -->
                <div class="mb-3 text-start">
                    <label class="form-label small fw-bold text-muted">Confirm Password</label>
                    <div class="input-group">
                        <input type="password"
                               name="confirm_password"
                               id="confirmPasswordField"
                               class="form-control py-2"
                               placeholder="Re-type new password"
                               required>
                        <button class="btn btn-outline-secondary"
                                type="button"
                                onclick="togglePassword('confirmPasswordField', 'eyeIcon2')">
                            <i id="eyeIcon2" class="fas fa-eye-slash"></i>
                        </button>
                    </div>
                </div>

                <div class="mb-2 text-start">
                    <small class="text-muted">
                        Use at least 8 characters. Avoid sharing this password with anyone.
                    </small>
                </div>

                <button type="submit"
                        class="btn btn-success w-100 fw-bold py-2 mt-2">
                    <i class="fas fa-lock-open me-1"></i> Update Password
                </button>
            </form>

            <div class="mt-4">
                <a href="{{ url_for('login') }}"
                   class="small text-secondary fw-bold">
                    Back to Login
                </a>
            </div>
        </div>

    </div>
</div>

<script>
    function togglePassword(inputId, iconId) {
        const input = document.getElementById(inputId);
        const icon = document.getElementById(iconId);
        if (!input || !icon) return;

        if (input.type === "password") {
            input.type = "text";
            icon.classList.remove("fa-eye-slash");
            icon.classList.add("fa-eye");
        } else {
            input.type = "password";
            icon.classList.remove("fa-eye");
            icon.classList.add("fa-eye-slash");
        }
    }
</script>
{% endblock %}
